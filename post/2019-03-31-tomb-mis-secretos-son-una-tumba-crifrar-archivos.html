<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tomb. Mis secretos son una Tumba. Crifrar Archivos</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="Hoy toca el turno de Tomb. Un script para cifrar archivos muy pero que muy interesante"
 />
<meta name="keywords" content="raspberry,servidor" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-131560140-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date())
gtag('config', 'UA-131560140-1');
</script>
<link rel=canonical href=https://ugeek.github.io />
<meta property=og:type content=website />
<meta property=og:locale content=es_ES />
<meta property=og:title content=Blog de uGeek />
<meta name=author content=Angel. uGeek />
<meta property=og:site_name content=uGeek. Blog de Tecnología/>
<meta property=og:description content=uGeek. Blog y Podcast de Tecnología sobre GNU/Linux, Android, Domotica,... />
<meta property=og:image content=https://ugeek.github.io/icon/ugeek-256x256.png />
<meta property=og:image content=https://ugeek.github.io/ugeek.jpg />
<meta property=og:image:secure_url content=https://ugeek.github.io/ugeek.jpg />
<meta property=og:image:width content=640 />
<meta property=og:image:height content=366 />
<meta name=twitter:site content=@ugeekpodcast />
<meta name=twitter:card content=summary_large_image />
<meta name=twitter:site content=@ugeekpodcast />
<meta name=twitter:image content=https://ugeek.github.io/icon/ugeek-256x256.png />
<link rel=shortcut icon href=https://ugeek.github.io/icon/ugeek-256x256.png type=image/x-icon />
<link rel=icon href=https://ugeek.github.io/icon/ugeek-256x256.png sizes=32x32 />
<link rel=icon href=https://ugeek.github.io/icon/ugeek-256x256.png sizes=192x192 />
<link rel=apple-touch-icon-precomposed href=https://ugeek.github.io/icon/ugeek-256x256.png />
<link rel=alternate type=application/rss+xml title=uGeek. Blog de Tecnología href=https://ugeek.github.io/feed/ />
<div id="logo"><a href="https://ugeek.github.io"><img src="../icon/ugeek.png" border="0"  width="90" height="90" alt="uGeek"></a></div>
<link rel="stylesheet" type="text/css" href="../css/stylesheet.css" /><link rel="alternate" type="application/rss+xml" href="https://ugeek.github.io/feed.xml" title="uGeek - Blog de Tecnología">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'/>
<div id="name"><a href="https://ugeek.github.io/"><tt>Blog del Podcast</tt></div></a>
<div id="icon"><a href="http://feeds.feedburner.com/uGeek" title="rss" alt="rss"><img src="../icon/podcast.png"  width="25" height="25" alt="podcast"></a>&nbsp;&nbsp;<a href="http://feeds.feedburner.com/uGeekBlog" alt="rss"><img src="../icon/rss.png"  width="25" height="25"></a>&nbsp;&nbsp;<a href="https://github.com/ugeek"><img src="../icon/github.png"  width="25" height="25" alt="GitHub"></a>&nbsp;&nbsp;<a href="https://twitter.com/ugeekpodcast"><img src="../icon/twitter.png"  width="25" height="25" alt="Twitter"></a>&nbsp;&nbsp;<a href="https://t.me/uGeek"><img src="../icon/telegram.png"  width="25" height="25" alt="Telegram"></a></div>
<div id="menu"><a href="https://ugeek.github.io/blog/list.html"><tt>Artículos</tt></a>&nbsp;&nbsp;<a href="https://ugeek.github.io/list.html"><tt>Podcasts</tt></a>&nbsp;&nbsp;<a href="https://ugeek.github.io/tags.html"><tt>Tags</tt></a></div>

<br><br><br><br><br><br><br><br><br><br>

<div id="outline-container-org4533a05" class="outline-2">
<h2 id="org4533a05">Tomb. Mis secretos son una Tumba. Crifrar Archivos</h2>
<div class="outline-text-2" id="text-org4533a05">
<p>
Seguimos con la serie de aplicaciones para cifrar nuestros archivos. Hoy toca el turno de Tomb. Un script para cifrar archivos muy pero que muy interesante.
</p>


<div class="figure">
<p><img src="../images-blog/tomb.png" alt="tomb.png" />
</p>
</div>

<p>
Tomb es aplicación basada en un script de software libre que nos permite crear un archivo cifrado en forma de contenedor, que llamaremos tomb "tumba" y que posteriormente podremos montar como si fuera un USB o HDD. Es una aplicación muy parecida a <a href="https://ugeek.github.io/blog/post/2019-03-29-veracrypt-en-ubuntu-y-tu-raspberry-por-terminal.html">Veracrypt, que hablé en el Post anterior</a>. Su código está disponible en <a href="https://github.com/dyne/Tomb">este repositorio de GitHub</a>, así que si tenemos conocimientos, podemos ver como está hecho y eso da una muy buena confiabilidad.
</p>

<p>
Después de haber crear el la tumba (contenedor), crearemos la llave para abrir esta. Deberemos guardar muy bien esta llave, ya que si la perdemos, perderemos nuestros archivos para siempre. En la parte final del Post, explico como convertir la llave en una imagen, por ejemplo, para despistar a posibles intrusos. 
</p>

<p>
<b>Recordar que no es nada aconsejable dejar la llave junto a la tumba.</b>
</p>
</div>

<div id="outline-container-org9fb9e31" class="outline-3">
<h3 id="org9fb9e31">Instalación en Ubuntu 18.04</h3>
<div class="outline-text-3" id="text-org9fb9e31">
<p>
En Ubuntu lo tenemos muy facil, tan simple como instalar desde los repositorios:
</p>

<p>
<code>sudo apt install tomb</code>
</p>
</div>
</div>

<div id="outline-container-org4cb255b" class="outline-3">
<h3 id="org4cb255b">Instalando en Raspberry con Raspbian</h3>
<div class="outline-text-3" id="text-org4cb255b">
<p>
Comenzamos instalando:
</p>

<p>
<code>sudo apt-get install gettext zsh cryptsetup pinentry-curses</code>
</p>

<p>
Descargamos la última versión desde <a href="https://files.dyne.org/tomb/">aquí</a>:
</p>

<p>
<code>wget https://files.dyne.org/tomb/Tomb-2.5.tar.gz</code>
</p>

<p>
Descomprimimos:
</p>

<p>
<code>tar xzvf Tomb-2.5.tar.gz</code>
</p>

<p>
Accedemos a la carpeta y compilamos:
</p>

<pre class="example">
cd Tomb-2.5/
sudo make install
</pre>
<p>
Después instalamos:
</p>
<pre class="example">
sudo install -Dm755 tomb /usr/local/bin/tomb
sudo install -Dm644 doc/tomb.1 /usr/local/share/man/man1/tomb.1
</pre>
<p>
Ya está instalado!!! Parecía mas complicado&#x2026;
</p>
</div>
</div>

<div id="outline-container-org5b41098" class="outline-3">
<h3 id="org5b41098">Creando la Tumba</h3>
<div class="outline-text-3" id="text-org5b41098">
<p>
Vamos a crear nuestra primera tumba, dentro de esta, añadiremos los archivos que queremos que queden cifrados. Si nuestra máquina tiene activa la swap, deberemos utilizar el tag <b>-f</b> al final del comando, para que no deje rastro alguno de los archivos que contiene nuestra tumba.
</p>

<p>
Creamos la Tumba con 100Mb de Tamaño:
</p>

<p>
<code>tomb dig -s 100 documentos.tomb -f</code> 
</p>


<p>
Ahora crearemos la llave e introduciremos la contraseña. Paciencia porque este proceso, puede tardar en función del tamaño, unos minutos. También nos pedirá la contraseña del usuario con permisos sudo.
</p>

<p>
<code>tomb forge -k documentos.tomb.key -f</code>  
</p>


<p>
Ya se habrá creado tanto la tumba como la llave. La llave llevará el nombre de la tumba, pero si queremos podemos renombrarla.
</p>

<p>
Cerraremos el contenedor con la llave creada.
</p>

<p>
<code>tomb lock -k documentos.tomb.key documentos.tomb</code>
</p>
</div>
</div>

<div id="outline-container-org29d312a" class="outline-3">
<h3 id="org29d312a">Abrir la tumba</h3>
<div class="outline-text-3" id="text-org29d312a">
<p>
Para abrir la tumba y comenzar a guardar archivos dentro de ella, necesitaremos la llave. Yo estoy utilizando el mismo directorio, pero si está en otro, especificar la ruta completa de donde esté:
</p>

<p>
<code>tomb open -k documentos.tomb.key documentos.tomb -f</code>
</p>

<p>
Normalmente, el volumen se montará en <code>/media/documentos/</code>.
</p>
</div>
</div>

<div id="outline-container-org1a3e9b1" class="outline-3">
<h3 id="org1a3e9b1">Cerrar tumba</h3>
<div class="outline-text-3" id="text-org1a3e9b1">
<p>
Para cerrar la tumba, súper sencillo. Utilizaremos <b>close</b>:
</p>

<p>
<code>tomb close</code>
</p>

<p>
Cerrar todas las tumbas y aplicaciones que se están haciendo uso de los archivos que están en las tumbas:
</p>

<p>
<code>tomb slam all</code>
</p>
</div>
</div>

<div id="outline-container-orgffc3eef" class="outline-3">
<h3 id="orgffc3eef">Ocultando tu llave en una foto</h3>
<div class="outline-text-3" id="text-orgffc3eef">
<p>
Primero tenemos que instalar steghide
</p>

<p>
<code>sudo apt install steghide</code>
</p>

<p>
Eligimos una imagen para guardar dentro la llave, en mi caso se llamará <b>imagen.jpg</b>. Nos pedirá una contraseña
</p>

<p>
<code>tomb bury -k documentos.tomb.key imagen.jpg</code>
</p>

<p>
Ya podemos eliminar nuestra llave, porque esta, está en el interior de la imagen oculta.
</p>

<p>
Para poder volver a extraer la llave de la imagen:
</p>

<p>
<code>tomb exhume -k nombredellave imagen.jpg</code> 
</p>


<p>
Para abrir nuestra tumba con la imágen:
</p>

<p>
<code>tomb open -k imagen.jpg documentos.tomb</code>
</p>
</div>
</div>

<div id="outline-container-orgb9a584e" class="outline-3">
<h3 id="orgb9a584e">Listar tumbas abiertas</h3>
<div class="outline-text-3" id="text-orgb9a584e">
<p>
Vamos a listar todas las tumbas abiertas e información sobre el tamaño, espacio libre,&#x2026;
</p>

<p>
<code>tomb list</code>
</p>
</div>
</div>

<div id="outline-container-orge1d2f5a" class="outline-3">
<h3 id="orge1d2f5a">Ampliar mas tamaño</h3>
<div class="outline-text-3" id="text-orge1d2f5a">
<p>
Una de las cosas que más me ha gustado, es que una vez creada la tumba, no estamos limitados para siempre a ese tamaño, sino que podemos modificarlo pero solo para ampliarlo. Voy a ampliar de 100Mb iniciales a 350Mb:
</p>

<p>
<code>tomb resize -s 310 -k imagen.jpg documentos.tomb -f</code>
</p>

<p>
En el momento de la ampliación, nos pedirá la llave y contraseña.
</p>
</div>
</div>

<div id="outline-container-org9a56986" class="outline-3">
<h3 id="org9a56986">Mas Ayuda</h3>
<div class="outline-text-3" id="text-org9a56986">
<p>
Sintaxis:
</p>

<p>
<code>tomb [opciones]  [argumentos]</code>
</p>

<p>
Podemos ver todas las opciones con el comando de ayuda o accediendo al manual:
</p>

<p>
<code>tomb -h</code>
</p>


<p>
<code>man tomb</code>
</p>
</div>
</div>

<div id="outline-container-org97b6eb3" class="outline-3">
<h3 id="org97b6eb3">Conclusión</h3>
<div class="outline-text-3" id="text-org97b6eb3">
<p>
Voy a darle la oportunidad a este método de cifrar los archivos durante un tiempo, porque me parece muy sencillo, ligero y sobretodo confiable, ya que el código del script está hecho de un modo lo mas legible posible y utilizando herramientas de software libre muy bien auditadas.
</p>

<p>
Disponemos también de varias versiones con interfaz gráfica para escritorio, como por ejemplo <b>gtomb</b>. No puedo hablar de ella porque no la he probado, pero para aquellos que no les guste la terminal, es una buena solución. Recordaros que igual que en el <a href="https://ugeek.github.io/blog/post/2019-03-29-veracrypt-en-ubuntu-y-tu-raspberry-por-terminal.html">Post anterior de Veracrypt</a>, recomiendo el utilizar <b>alias</b> para abrir y cerrar las tumbas, solo por no tener que recordar los comando.
</p>
</div>
</div>


<div id="outline-container-orga816d97" class="outline-3">
<h3 id="orga816d97">Fuentes</h3>
<div class="outline-text-3" id="text-orga816d97">
<ul class="org-ul">
<li><a href="http://www.dyne.org/software/tomb/">Web de Tomb</a></li>
<li><a href="https://github.com/dyne/Tomb/wiki">Wiki de Tomb</a></li>
</ul>
<br>
<p>
Publicado por Angel el domingo 31 marzo del 2019  
</p>
<br><br>
<p>
También te puede interesar:
</p>

<ul class="org-ul">
<li><a href="https://ugeek.github.io/blog/post/2019-03-29-veracrypt-en-ubuntu-y-tu-raspberry-por-terminal.html">Veracrypt en Ubuntu y tu Raspberry por Terminal</a></li>
<li><a href="https://ugeek.github.io/blog/post/2019-01-17-gpg-cifrado-de-archivos-simetrico.html">GPG. Cifrado de archivos simétrico</a></li>
</ul>
<br><br><br><p style="text-align: center;">Powered by <a href="https://github.com/ugeek/org-bash-blog" target="_blank" rel="noopener">org-bash-blog</a></p><br><p style="text-align: center;">Writing in orgmode whith emacs</p> <p style="text-align: center;"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license"><img style="border-width: 0px; display: block; margin-left: auto; margin-right: auto;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Licencia de Creative Commons" /></a><br />Este obra est&aacute; bajo una <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">licencia de Creative Commons Reconocimiento-NoComercial-CompartirIgual 4.0 Internacional</a>.</p><br><br><br>
</div>
</div>
</div>
</div>
</body>
</html>
